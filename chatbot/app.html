<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chat Bot</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body data-page="app">
  <!-- Shared neural background (matches index/signup) -->
  <div class="neural-background">
    <div class="neural-node"></div><div class="neural-node"></div>
    <div class="neural-node"></div><div class="neural-node"></div>
    <div class="neural-node"></div>
  </div>

  <!-- Centered shell like login/signup, but roomy enough for two cards -->
  <div class="login-container" style="max-width:1120px;">
    <div class="login-card" style="padding:18px 18px 22px;">
      <div class="ai-glow"></div>

      <!-- Header matches index/signup -->
      <div class="login-header" style="margin-bottom:14px;">
        <div class="ai-logo">
          <div class="logo-core">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="1.5"/>
              <path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"
                    stroke="currentColor" stroke-width="1.5"/>
            </svg>
          </div>
          <div class="logo-rings">
            <div class="ring ring-1"></div>
            <div class="ring ring-2"></div>
            <div class="ring ring-3"></div>
          </div>
        </div>
        <h1>Welcome</h1>
        <p>Chat with your on-device model</p>
      </div>

      <!-- Top right action (same button style as auth pages) -->
      <div class="row" style="justify-content:flex-end; margin-bottom:16px;">
        <button id="signOutBtn" class="neural-button signout-big" title="Sign out">
          <div class="button-bg"></div>
          <span class="button-text">Sign out</span>
          <div class="button-loader" aria-hidden="true">
            <div class="neural-spinner">
              <div class="spinner-segment"></div>
              <div class="spinner-segment"></div>
              <div class="spinner-segment"></div>
            </div>
          </div>
          <div class="button-glow"></div>
        </button>
      </div>

      <!-- Two-column content, styled to feel like two “login-card” halves -->
      <div class="section-grid" style="display:grid; grid-template-columns:1fr 1.6fr; gap:28px;">
        <!-- Account card (left) -->
        <section class="info-card glass-card" style="position:relative; padding:16px 16px 18px;">
          <div class="ai-glow" aria-hidden="true"></div>
          <strong id="accountTitle" style="display:block; margin-bottom:8px;">Account</strong>
          <div class="muted" style="margin-top:6px;">Email: <span id="userEmail">(loading…)</span></div>
          <!-- Keep UID node for safety but hidden -->
          <div style="display:none;">UID: <span id="userUid"></span></div>

          <div class="spacer" style="height:12px;"></div>

          <!-- Load AI + progress host (script.js renders the bar + “Model:” under it) -->
          <div class="row" style="gap:12px; align-items:center; flex-wrap:wrap;">
            <button id="loadModelBtn" class="neural-button" style="min-height:42px;" title="Download and initialize the on-device model">
              <div class="button-bg"></div>
              <span class="button-text">Load AI</span>
              <div class="button-glow"></div>
            </button>

            <div class="progress-wrap" style="min-width:260px; flex:1; max-width:600px;">
              <div id="initProgress"></div>
            </div>
          </div>


        </section>

        <!-- Chat card (right) -->
        <section class="info-card glass-card" aria-labelledby="chatTitle" style="position:relative; padding:16px 16px 18px; display:flex; flex-direction:column;">
          <div class="ai-glow" aria-hidden="true"></div>
          <div class="row" style="justify-content:space-between; align-items:center;">
            <strong id="chatTitle">Chatbot</strong>
          </div>

          <!-- History (same rounded/glass language as auth inputs/buttons) -->
          <div id="chatLog" aria-live="polite" aria-label="Chat history"
               style="margin-top:12px; height:clamp(260px, 40vh, 420px); overflow:auto; padding:12px; border-radius:16px; background:rgba(255,255,255,.03); box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);">
          </div>

          <!-- Composer: textarea full width ABOVE send (mirrors tidy, rounded inputs) -->
          <div class="stack" style="margin-top:12px; gap:10px;">
            <label for="chatInput" class="visually-hidden">Message</label>
            <textarea id="chatInput" rows="3" placeholder="Type your message…"
              style="width:100%; resize:vertical; border-radius:14px; padding:12px; background:rgba(255,255,255,.05); color:inherit; border:0; box-shadow: inset 0 0 0 1px rgba(255,255,255,.08)"></textarea>

            <div class="row" style="justify-content:flex-end;">
              <button id="sendMsgBtn" class="neural-button" style="min-width:140px; min-height:46px;" title="Send message">
                <div class="button-bg"></div>
                <span class="button-text">Send</span>
                <div class="button-glow"></div>
              </button>
            </div>
          </div>
        </section>
      </div>

      <!-- Subtle footer like auth pages -->
      <div style="margin-top:24px; text-align:center;">
        <p class="muted" style="font-size:12px;">Signed in? You can always <a href="index.html" class="neural-login">switch accounts</a>.</p>
      </div>
    </div>
  </div>

  <!-- Load your JS as a module so Firebase imports work -->
  <script src="script.js" type="module"></script>

  <!-- Small local tweaks to align with auth pages -->
  <style>
    /* Ensure scroll at 100% zoom */
    html, body { height:auto; min-height:100%; overflow-y:auto; }
    body { overscroll-behavior-y:contain; }

    /* Match spacing language from auth screens */
    .section-grid { gap:28px !important; }
    @media (max-width: 980px) {
      .section-grid { grid-template-columns:1fr; }
    }

    /* Glass cards mimic login-card internals */
    .glass-card {
      border:0;
      border-radius:22px;
      background:rgba(255,255,255,0.06);
      box-shadow:
        0 10px 30px rgba(0,0,0,.25),
        inset 0 0 0 1px rgba(255,255,255,.08);
      backdrop-filter: blur(10px) saturate(130%);
      -webkit-backdrop-filter: blur(10px) saturate(130%);
    }

    /* Buttons match the neural style used on index/signup */
    .signout-big {
      min-width:160px; min-height:50px; padding:10px 18px;
      font-size:16px; font-weight:600; border-radius:16px;
    }
    .neural-button { background:transparent; border-radius:14px; }
    .neural-button .button-bg {
      background:rgba(255,255,255,0.06);
      box-shadow: 0 6px 18px rgba(0,0,0,.25), inset 0 0 0 1px rgba(255,255,255,.10);
      backdrop-filter: blur(10px) saturate(140%);
      -webkit-backdrop-filter: blur(10px) saturate(140%);
      border:0; border-radius:14px;
    }
    .neural-button .button-text { color:rgba(255,255,255,0.95); }
    .neural-button:hover .button-bg {
      background:rgba(255,255,255,0.12);
      transform:translateY(-1px);
      box-shadow: 0 10px 22px rgba(0,0,0,.28), inset 0 0 0 1px rgba(255,255,255,.16);
    }
    .neural-button:active .button-bg {
      transform:translateY(0);
      box-shadow: 0 6px 16px rgba(0,0,0,.22), inset 0 0 0 1px rgba(255,255,255,.12);
    }

    /* a11y helper (matches earlier pages) */
    .visually-hidden {
      position:absolute !important; height:1px; width:1px;
      overflow:hidden; clip:rect(1px,1px,1px,1px);
      white-space:nowrap; border:0; padding:0; margin:-1px;
    }
  </style>
</body>
</html>